# Changelog - SaaS Factory

## [2.0.0] - 2026-01-15

### ğŸ”„ Flujo Mejorado

**CAMBIO MAYOR**: ReorganizaciÃ³n completa del flujo de ejecuciÃ³n para mejor consistencia y experiencia de usuario.

#### Nuevo Orden de EjecuciÃ³n

```
[1/10]  Crear proyecto Next.js
[2/10]  Instalar deps PostgreSQL + Auth
[3/10]  Instalar deps UI/UX
[4/10]  Crear estructura de carpetas
[5/10]  Generar archivos de configuraciÃ³n
[6/10]  Crear base de datos (si --create-db) â­ ANTES
[7/10]  Prisma migrate + generate â­ ANTES
[8/10]  Configurar MCP (por defecto) â­ ANTES de Git
[9/10]  Configurar Tests (si --with-tests) â­ ANTES de Git
[10/10] Git init + commit (incluye TODO)
---
[Post]  DNS/Tunnel setup
[Post]  Auto-deploy (si --deploy)
```

#### Cambios EspecÃ­ficos

**1. Base de datos ahora se crea ANTES de Prisma**
- Antes: Prisma generate â†’ (mucho despuÃ©s) â†’ Crear DB
- Ahora: Crear DB â†’ Prisma migrate â†’ Git commit
- Beneficio: Sin errores de conexiÃ³n, migraciÃ³n automÃ¡tica si --create-db

**2. MCP se configura ANTES del commit inicial**
- Antes: Git commit â†’ MCP setup (archivos fuera de Git)
- Ahora: MCP setup â†’ Git commit (archivos incluidos)
- Beneficio: `.mcp.json`, `.claudeignore`, `CLAUDE.md`, `GEMINI.md` en commit inicial

**3. Tests configurados ANTES del commit**
- Antes: Tests despuÃ©s de Git (archivos fuera del repositorio)
- Ahora: Tests â†’ Git commit (todo incluido)
- Beneficio: Tests y CI/CD en commit inicial

**4. ValidaciÃ³n de flags incompatibles**
- Error si `--dns` y `--tunnel` juntos
- Advertencia si `--deploy` sin `--create-db`

**5. Mensajes de resumen mejorados**
- Estado claro de cada componente (âœ“ o pendiente)
- Comandos contextuales segÃºn configuraciÃ³n
- Sin mensajes contradictorios

#### Commit DinÃ¡mico

El mensaje del commit inicial ahora incluye dinÃ¡micamente lo que se configurÃ³:

```
ğŸ‰ Initial commit - Generated by SaaS Factory

Stack:
- Next.js 14 (App Router)
- PostgreSQL + Prisma (DB migrada)      â† Si --create-db
- NextAuth.js v5
- TypeScript + Tailwind CSS
- MCP (8 servers configurados)          â† Si MCP activo
- Vitest + Playwright + CI/CD           â† Si --with-tests

Port: 3000
Database: mi_db
```

### âœ¨ Mejoras

#### Flujo de Usuario
- **Sin pasos manuales extras**: Si usas `--create-db`, la DB estÃ¡ lista y migrada
- **Todo en Git desde el inicio**: MCP, tests, migraciones incluidas
- **Mensajes claros**: Sabes exactamente quÃ© estÃ¡ configurado y quÃ© falta

#### Mensajes Mejorados
- Indicadores de estado: `[âœ“ Creada y migrada]` o `[Pendiente]`
- Comandos contextuales segÃºn flags
- Resumen final estructurado

### ğŸ”§ Archivos Modificados

- `saas-factory.sh`: ReorganizaciÃ³n completa (1646 lÃ­neas)
- `docs/flujo_mejorado.md`: DocumentaciÃ³n del anÃ¡lisis
- `CHANGELOG.md`: Este archivo

### ğŸ“Š ComparaciÃ³n

#### Antes (v1.x)
```bash
saas-factory mi-app mi_db --create-db --dns

# Resultado:
# - DB creada DESPUÃ‰S de Prisma (posibles errores)
# - MCP fuera del commit inicial
# - Tests fuera del commit inicial
# - Mensajes confusos ("crea la DB" cuando ya se creÃ³)
```

#### Ahora (v2.0)
```bash
saas-factory mi-app mi_db --create-db --dns

# Resultado:
# âœ… DB creada Y migrada ANTES de Prisma
# âœ… MCP configurado e incluido en commit inicial
# âœ… Todo en Git desde el primer commit
# âœ… Mensajes claros: "Base de datos: mi_db [âœ“ Creada y migrada]"
```

### ğŸ¯ Beneficios

1. **Commit inicial completo**: Incluye proyecto + MCP + tests + migraciones
2. **Sin errores de conexiÃ³n**: DB existe cuando Prisma la necesita
3. **Experiencia consistente**: El orden tiene sentido lÃ³gico
4. **Mensajes precisos**: Usuario sabe exactamente quÃ© estÃ¡ listo
5. **Menos pasos manuales**: Con `--create-db` todo estÃ¡ listo para `npm run dev`

### ğŸ“ Ejemplos

#### Proyecto completo con todo configurado
```bash
saas-factory awesome-app awesome_db --create-db --tunnel --with-tests

# Resultado:
# âœ… Proyecto Next.js 14
# âœ… DB creada y migrada
# âœ… MCP configurado (8 servers)
# âœ… Tests + CI/CD configurados
# âœ… Tunnel a awesome-app.emanuel-server.com
# âœ… Todo en Git commit inicial
```

#### Solo proyecto base (sin extras)
```bash
saas-factory simple-app simple_db

# Resultado:
# âœ… Proyecto Next.js 14
# âœ… MCP configurado (por defecto)
# âš ï¸  DB pendiente (crÃ©ala manualmente)
# âœ… Todo en Git commit inicial
```

### ğŸ”„ MigraciÃ³n desde v1.x

Si tienes proyectos creados con v1.x:

**No hay breaking changes** en proyectos existentes. Los cambios solo afectan la creaciÃ³n de nuevos proyectos.

Para proyectos antiguos sin MCP:
```bash
cd mi-proyecto-antiguo
/ruta/a/saas-factory/scripts/setup-mcp.sh mi-proyecto mi_db
```

### ğŸ› Bugs Corregidos

1. **Prisma Client generado sin DB**: Ahora DB se crea primero
2. **MCP fuera de Git**: Ahora incluido en commit inicial
3. **Tests fuera de Git**: Ahora incluido en commit inicial
4. **Mensajes contradictorios**: Mensajes contextuales segÃºn estado
5. **No validaba flags incompatibles**: Ahora valida y muestra error claro

### ğŸ“š DocumentaciÃ³n

#### ConsolidaciÃ³n y ActualizaciÃ³n v2.0
- âœ… **README.md**: Actualizado con v2.0, tabla de flags, flujo de 10 pasos
- âœ… **QUICKSTART.md**: Consolidado con secciÃ³n "Uso con IA" y tabla de tiempos
- âœ… **CADDY_CONFIG.md**: Documentado flag `--deploy` con integraciÃ³n automÃ¡tica
- âœ… **saas_factory_cheatsheet.md**: Reducido 35% (673â†’440 lÃ­neas) y actualizado v2.0
- âœ… **SAAS_FACTORY_INDEX.md**: Reorganizado con estructura v2.0
- âŒ **Eliminados**: 6 archivos temporales de estado y planning
- ğŸ“¦ **Archivado**: `docs/flujo_mejorado.md` movido a `docs/archive/`
- **ReducciÃ³n total**: ~26% menos contenido sin perder informaciÃ³n importante

---

## [1.0.0] - 2026-01-14

### CaracterÃ­sticas Iniciales

- âœ… Generador de proyectos Next.js 14 + PostgreSQL
- âœ… NextAuth.js v5 configurado
- âœ… Prisma ORM con schema completo
- âœ… Cloudflare DNS automation (--dns)
- âœ… Cloudflare Tunnel support (--tunnel)
- âœ… PostgreSQL automation (--create-db)
- âœ… MCP configuration (8 servers)
- âœ… Auto-deploy con PM2 + Caddy (--deploy)
- âœ… Testing setup (--with-tests)
- âœ… Docker support
- âœ… Git initialization

---

**Mantenido por**: SaaS Factory Team
**Repositorio**: https://github.com/epardo0910/saas-factory
